<body>
</body>

<script src="float.js"></script>
<script src="view.js"></script>
<script src="animation.js"></script>

<script>

TOTAL_WIDTH = document.body.clientWidth;
TOTAL_HEIGHT = document.body.clientHeight;
TOTAL_BARS = 25;

var barViews = [];

for (var i = 0; i < TOTAL_BARS; i++) {
    barViews[i] = barViewForIndex(i, TOTAL_BARS);
    barViews[i].embedIn(document.body);
}

function barViewForIndex(index, totalbars) {
	var barPadding = 10;
	var barWidth = (TOTAL_WIDTH / totalbars) - barPadding + (barPadding / totalbars);
	var xposition = barWidth * index;
    if (xposition > 0) {
        xposition += barPadding * index;
    }

	var view = View.viewWithFrame(xposition, TOTAL_HEIGHT, barWidth, 0);
	view.setBackgroundColor('gray');
	return view
}

function animateBars() {
    for (var i = 0; i < TOTAL_BARS; i++) {
        console.log("animating" + i);
        if (randBetween(0, 2) == 1) {
            Animation.animate(barViews[i], 0.4, function(view) {
                var height = randBetween(0, TOTAL_HEIGHT) * .8;
                console.log(height);
                console.log(height);
                view.setY(TOTAL_HEIGHT - height);
                view.setHeight(height);
                return view;
            });
        }
    }
}

function randBetween(a, b) {
    return Math.floor(Math.random() * b) + a;
}

setInterval(function() { animateBars() }, 500);

</script>