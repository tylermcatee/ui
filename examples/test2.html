<body>
</body>

<script src="../utilities/float.js"></script>
<script src="../utilities/color.js"></script>
<script src="../views/view.js"></script>
<script src="../events/eventhandler.js"></script>
<script src="../views/imageview.js"></script>
<script src="../animation/animation.js"></script>
<script src="../controllers/viewcontroller.js"></script>
<script src="../views/window.js"></script>

<script>

class MainViewController extends ViewController {

	viewDidLoad() {
		super.viewDidLoad();

		this.squareView = View.viewWithFrame(50.0, 50.0, 100.0, 100.0);
		this.squareView.setBorderRadius(20.0);
		this.squareView.setBackgroundColor('red');
		this.view.addSubview(this.squareView);

		this.isRed = true;

		var squareClickHandler = EventHandler.clickHandler(this.handleClick.bind(this));
		this.squareView.addEventHandler(squareClickHandler);

		var viewClickHandler = EventHandler.clickHandler(this.handleClick.bind(this));
		this.view.addEventHandler(viewClickHandler);
	}

	handleClick(clickHandler) {
		var target = clickHandler.target;
		if (target == this.squareView) {
			if (this.isRed) {
			Animation.animate(target, 0.25, function(view) {
				view.setBackgroundColor('blue');
			});
			this.isRed = false;
			} else {
				Animation.animate(target, 0.25, function(view) {
					view.setBackgroundColor('red');
				});
				this.isRed = true;
			}
		} else {
			Animation.animate(this.squareView, 0.25, function(view) {
				view.setBackgroundColor('green');
			});
		}
	}
}

var viewController = new MainViewController();
Window.mainWindow().setRootViewController(viewController);

</script>